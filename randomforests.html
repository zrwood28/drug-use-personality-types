<!DOCTYPE html>
<html lang="en-us">

<head>
  <link rel="icon" href="images/personality.png">
    <meta charset="utf-8">
    <title>Random Forest Classification</title>
    <!-- Bring in the Bootstrap stylesheet -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">
    <!-- My CSS -->
    <link rel="stylesheet" type="text/css" href="style/style.css">
</head>

<body>
    <!-- NAVBAR ------------------------------------------------------------>
  <nav class="navbar navbar-expand-lg">
    <a class="navbar-brand" href="index.html">
      <img src="images/head_gif.gif" height="52" width="52">
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav mr-auto">        
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              Models
            </a>
            <ul class="dropdown-menu">
              <li><a class="dropdown-item" href="randomforests.html">Random Forests</a></li>
              <li><a class="dropdown-item" href="logisticregression.html">Logistic Regression</a> </li>                 
              <li><a class="dropdown-item" href="svw.html">Support Vector Machine</a></li>
              <li><a class="dropdown-item" href="neuralnetwork.html">Neural Network</a></li>
            </ul>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="analysis.html">Analysis</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="data.html">Data</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="team.html">Team</a>
          </li>
        </ul>
      </div>
    </nav>
    <!-- NAVBAR ------------------------------------------------------------>

    <!-- BODY ------------------------------------------------------------>
    <div class="container">
      <div class="row">
        <div class="col-md-12 main">
          <h1 class="rfc">Random Forests Classification</h1>
          <br>
          <h2>Introduction</h2>
          <p>Random Forests is a method for classification that utilizes a large quantity of decision trees with the training set.
            When utilizing Random forests for classification, the output is the class elected by the most "trees."
          </p>
          <img class="img1" src="images/Random_forest_diagram.png">
          <p class="center">Source: https://en.wikipedia.org/wiki/Random_forest#/media/File:Random_forest_diagram_complete.png</p>
          <br>
          <h2>Results</h2>
          <p>The Random Forests models were generated with the Ptyhon library scikit-learn from the ensemble method.
            Initially the model was outputting a 1.0 training score which indicated that the model was being overfitted. 
            In order to avoid this issue, the max_depth parameter of the model was modified to create a better result.
            The max_depth parameter essentially tells the model how in depth it should go to find the answer it is looking for. 
            By default, there is no max_depth unless specified in the Random Forest model, so a potential result of this is an overfit dataset.</p>
            <br>
            <h4>All Features Model</h4>
            <p>In the Random Forest classification models, all of the drug specific columns were dropped from the dataset leaving just the illegal_use column which is indicated by a 0 or a 1.
            The 0 indicates no drug use within the last year and 1 indicates the participant had used an illegal drug in the last year.
            For the first attempt, all of the attributes were kept in the dataset except for the ID. As mentioned, the max_depth parameter was modified 
            such that testing score was optimized and such that the training score was below 1.0. This resulted in choosing max_depth of 10, and the below training and test scores were achieved respectfully:</p>
            <br>
            <p>Training Data Score: 94.5%</p>
            <p>Testing Data Score: 83.4%</p>
            <br>
            <p>A feature importance plot was generated to see if it might be worth removing some attributes from the model. In the below image, it is clear
              that the models most important feature is the Country origin of the UK. This makes sense given that 731 of the 1,043 UK participants had not used illegal drugs in the last year,
              and 312 participants had used illegal drugs in the last year. With a testing accuracty around 82% as listed above, the UK attribute split is relatively close to the model accuracy.
              Also seen in the image is that the ethnicities were not important relatively speaking. Even the white ethnicity attribute which consisted of over 1700 of the participants was the 10th lowest out of the 38 attributes being used in this first attempt.</p>
            <img class="img2" src="images/random_forest_feature_importance.png">
            <h4>Remove Ethnicity Attribute</h4>
            <p>With the ethnicity attribute removed, the model was ran again. The max_depth parameter was modified again to achieve an optimal testing score, 
              and resulted in choosing a max_depth of 11. This generated a slightly lower traning score at 96.0% and nearly identical test score at 83.2% . Below are the results:</p>
            <br>
            <p>Training Data Score: 96.0%</p>
            <p>Testing Data Score: 83.2%</p>
            <br>
            <h4>Remove Ethnicity and Country Attribute</h4>
            <p>With the Country-UK attribute being the most important feature, we removed it from the dataset out of curiousity. This model removed ethnicity and country, and a max_depth of 6 was utilized to achieve an optimal testing score. 
               The generated a lower scores again with a traning score at 83.5% and test score at 80.8% . Below are the results:</p>
              <br>
              <p>Training Data Score: 83.5%</p>
              <p>Testing Data Score: 80.8%</p>
        </div>
      </div>
    </div>



    <!-- BODY ------------------------------------------------------------>

    <!-- Import the Bootstrap JavaScript code -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js" integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa" crossorigin="anonymous"></script>

</body>
</html>